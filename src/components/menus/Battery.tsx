import { useBattery } from "~/hooks/useBattery";

export default function Battery() {
  const batteryState = useBattery();

  const width = () => {
    return 0.1 + batteryState.level * 0.96;
  };

  const color = () => {
    if (batteryState.charging) return "bg-green-400";

    if (batteryState.level < 0.2) return "bg-red-500";
    else if (batteryState.level < 0.5) return "bg-yellow-500";
    else return "bg-white";
  };

  return (
    <div className="flex items-center space-x-2">
      <span className="text-xs">{(batteryState.level * 100).toFixed()}%</span>
      <div className="relative flex items-center">
        <span className="i-bi:battery text-2xl" />
        <div className={`absolute rounded-[1px] h-2 top-1/2 -mt-1 ml-0.5 left-0 ${color()}`} style={{ width: `${width()}rem` }} />
        {batteryState.charging && (
          <span className="i-bi:lightning-charge-fill absolute inset-0 m-auto -translate-x-0.5 text-xs" />
        )}
      </div>
    </div>
  );
}
